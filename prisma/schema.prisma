generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  password  String
  isResettingPassword Boolean @default(false)
  resetPasswordToken String?   @unique

  // Relation avec Attendance (un utilisateur peut avoir plusieurs pointages)
  attendances Attendance[]
}

model Attendance {
  id         String   @id @default(cuid())
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  clockIn    DateTime
  clockOut   DateTime?
  latitude   Float @default(0.0)// Position GPS de l'utilisateur au moment du pointage
  longitude  Float @default(0.0) // Position GPS de l'utilisateur au moment du pointage
  locationId String?  @map("location_id") // Référence au lieu validé (optionnel si hors zone)
  location   Location? @relation(fields: [locationId], references: [id], onDelete: SetNull)
  createdAt  DateTime @default(now())
}

model Location {
  id         String  @id @default(cuid())
  name       String  @unique // Nom du lieu (ex: "Siège principal")
  latitude   Float  // Latitude du lieu
  longitude  Float  // Longitude du lieu
  radius     Float  // Rayon de validation en mètres (ex: 10m, 50m, etc.)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  // Relation avec Attendance (un lieu peut avoir plusieurs pointages associés)
  attendances Attendance[]
}